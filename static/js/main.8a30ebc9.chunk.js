(this["webpackJsonptic-tac-toe"]=this["webpackJsonptic-tac-toe"]||[]).push([[0],{110:function(e,t,r){"use strict";var n=r(37),a=r(38);Object.defineProperty(t,"__esModule",{value:!0}),t.wallet=t.SignType=t.NetWork=void 0;var i=r(24);i.bsv.crypto.Signature;!function(e){e.Testnet="testnet",e.Mainnet="mainnet",e.STN="STN"}(t.NetWork||(t.NetWork={})),function(e){e[e.ALL=65]="ALL",e[e.SINGLE=67]="SINGLE",e[e.NONE=66]="NONE",e[e.ANYONECANPAY_ALL=193]="ANYONECANPAY_ALL",e[e.ANYONECANPAY_SINGLE=195]="ANYONECANPAY_SINGLE",e[e.ANYONECANPAY_NONE=194]="ANYONECANPAY_NONE"}(t.SignType||(t.SignType={}));var o=function(){function e(t){n(this,e),this.network=t}return a(e,null,[{key:"toBsvTx",value:function(e){var t=new i.bsv.Transaction;return e.inputs.forEach((function(e){t.addInput(new i.bsv.Transaction.Input({prevTxId:e.utxo.txHash,outputIndex:e.utxo.outputIndex,script:e.script?i.bsv.Script.fromHex(e.script):new i.bsv.Script}),i.bsv.Script.fromHex(e.utxo.script),e.utxo.satoshis)})),e.outputs.forEach((function(e){t.addOutput(new i.bsv.Transaction.Output({script:i.bsv.Script.fromHex(e.script),satoshis:e.satoshis}))})),t}},{key:"toHexBsvTx",value:function(t){return e.toBsvTx(t).toString()}}]),e}();t.wallet=o},111:function(e,t,r){"use strict";(function(e){var n=r(112),a=r(53),i=r(115),o=r(116),c=r(65),u=r(85),s=r(37),l=r(38);Object.defineProperty(t,"__esModule",{value:!0}),t.buildTypeResolver=t.buildTypeClasses=t.buildStructsClass=t.buildContractClass=t.AbstractContract=void 0;var p=r(219),f=r(189),y=r(24),h=r(66),d=r(67),b=function(){function t(){s(this,t),this.calls=new Map,this.asmArgs=null}return l(t,[{key:"lockingScript",get:function(){var e=this.scriptedConstructor.toASM();if("string"===typeof this._dataPart){var t=this._dataPart.trim();e+=t?" OP_RETURN ".concat(t):" OP_RETURN"}return y.bsv.Script.fromASM(e.trim())}},{key:"txContext",get:function(){return this._txContext},set:function(e){this._txContext=e}},{key:"replaceAsmVars",value:function(e){this.asmArgs=e,this.scriptedConstructor.init(e)}},{key:"run_verify",value:function(r,n){var a=Object.assign({},this._txContext||{},n||{}),i=y.bsv.Script.fromASM(r.trim()),o=this.lockingScript,c=a.tx,u=a.inputIndex||0,s=a.inputSatoshis||0,l=y.bsv.Script.Interpreter(),p=0,f=[];l.stepListener=function(e,t,r){f.push(e),p++};var h=Object.getPrototypeOf(this).constructor.opcodes,d=l.verify(i,o,c,u,y.DEFAULT_FLAGS,new y.bsv.crypto.BN(s)),b=d?"":"VerifyError: ".concat(l.errstr);if(h){var g=r.trim().split(" ").length,v=t.findLastfExec(f,p);if("string"===typeof this._dataPart){h.push({opcode:"OP_RETURN",stack:[]});var m=this._dataPart.trim();m&&m.split(" ").forEach((function(e){h.push({opcode:e,stack:[]})}))}var S=v-g;if(p<h.length+g&&(S+=1),!d&&h[S]){var x=h[S];if(!x.pos||"std"===x.pos.file){var w=t.findSrcInfo(f,h,v,S);w&&(x.pos=w.pos)}if(x.pos){var A="undefined"===typeof e?y.path2uri(x.pos.file):x.pos.file;b="VerifyError: ".concat(l.errstr," \n\t[Go to Source](").concat(A,"#").concat(x.pos.line,")  fails at ").concat(x.opcode,"\n")}}}return{success:d,error:b}}},{key:"dataPart",get:function(){return void 0!==this._dataPart?y.bsv.Script.fromASM(this._dataPart):void 0},set:function(e){throw new Error("Setter for dataPart is not available. Please use: setDataPart() instead")}},{key:"setDataPart",value:function(e){this._dataPart="string"===typeof e?e.trim():f.serializeState(e)}},{key:"codePart",get:function(){var e=this.scriptedConstructor.toASM();return y.bsv.Script.fromASM(e+" OP_RETURN")}},{key:"arguments",value:function(e){return"constructor"===e?this.scriptedConstructor.args:this.calls.has(e)?this.calls.get(e).args:[]}}],[{key:"findSrcInfo",value:function(e,t,r,n){for(;--r>0&&--n>0;)if(t[n].pos&&"std"!==t[n].pos.file&&t[n].pos.line>0&&e[r].fExec)return t[n]}},{key:"findLastfExec",value:function(e,t){for(;--t>0;)if(e[t].fExec)return t}},{key:"getAsmVars",value:function(e,t){var r=e.match(/(\$\S+)/g);if(null===r)return null;for(var n=e.split(/\s/g),a=t.split(/\s/g),i={},o=0;o<n.length;o++)for(var c=0;c<r.length;c++)r[c]===n[o]&&(i[r[c].replace("$","")]=a[o]);return i}}]),t}();t.AbstractContract=b;var g=["arguments","setDataPart","run_verify","replaceAsmVars","asmVars","asmArguments","dataPart","lockingScript","txContext"];function v(e){var t={},r=e.structs||[],n=m(e.alias||[]);return r.forEach((function(e){var r=e.name;Object.assign(t,i({},r,function(e){c(r,e);var t=u(r);function r(e){var a;return s(this,r),(a=t.call(this,e))._typeResolver=n,a.bind(),a}return r}(h.Struct))),t[r].structAst=e})),t}function m(e){var t={};return e.forEach((function(r){var n=y.resolveType(e,r.name);t[r.name]=n})),function(e){y.isStructType(e)&&(e=y.getStructNameByType(e));var r="";if(y.isArrayType(e)){var n=y.arrayTypeAndSize(e),i=a(n,2);e=i[0],r=i[1].map((function(e){return"[".concat(e,"]")})).join("")}return h.BasicScryptType[e]?"".concat(e).concat(r):t[e]?"".concat(t[e]).concat(r):"struct ".concat(e," {}").concat(r)}}t.buildContractClass=function(e){if(!e.contract)throw new Error("missing field `contract` in description");if(!e.abi)throw new Error("missing field `abi` in description");if(!e.asm)throw new Error("missing field `asm` in description");e=e.errors?e:d.desc2CompileResult(e);var t=function(e){c(n,e);var r=u(n);function n(){var e,t;s(this,n),e=r.call(this);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];(i.length>0||n.abi.find((function(e){return"constructor"===e.type&&0===e.params.length})))&&(e.scriptedConstructor=(t=n.abiCoder).encodeConstructorCall.apply(t,[o(e),n.asm].concat(i)));return e}return l(n,[{key:"asmVars",get:function(){return b.getAsmVars(n.asm,this.scriptedConstructor.toASM())}},{key:"asmArguments",get:function(){return null}}],[{key:"fromASM",value:function(e){var t=new this;return t.scriptedConstructor=n.abiCoder.encodeConstructorCallFromASM(t,e),t}},{key:"fromHex",value:function(e){return t.fromASM(new y.bsv.Script(e).toASM())}}]),n}(b);return t.contractName=e.contract,t.abi=e.abi,t.asm=e.asm.map((function(e){return e.opcode.trim()})).join(" "),t.abiCoder=new p.ABICoder(e.abi,e.alias||[]),t.opcodes=e.asm,t.file=e.file,t.structs=e.structs,t.abi.forEach((function(e){if(g.indexOf(e.name)>-1)throw new Error("Method name [".concat(e.name,"] is used by scryptlib now, Pelease change you contract method name!"));t.prototype[e.name]=function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=t.abiCoder.encodePubFunctionCall(this,e.name,n);return this.calls.set(e.name,i),i}})),t},t.buildStructsClass=v,t.buildTypeClasses=function(e){var t=v(e),r={},o=e.alias||[],l=m(o);return o.forEach((function(e){var o=l(e.name);if(y.isStructType(o)){var p=y.getStructNameByType(o);Object.assign(r,i({},e.name,function(t){c(n,t);var r=u(n);function n(t){var a;return s(this,n),(a=r.call(this,t))._type=e.name,a._typeResolver=l,a}return n}(t[p])))}else if(y.isArrayType(o)){var f=y.arrayTypeAndSize(o),d=a(f,2),b=d[0];d[1];if(h.BasicScryptType[b])Object.assign(r,i({},e.name,function(e){c(r,e);var t=u(r);function r(){return s(this,r),t.apply(this,arguments)}return r}(n(Array))));else if(y.isStructType(b)){var g=y.getStructNameByType(b);t[g];Object.assign(r,i({},e.name,function(e){c(r,e);var t=u(r);function r(){return s(this,r),t.apply(this,arguments)}return r}(n(Array))))}}else{var v=h.BasicScryptType[o];if(!v)throw new Error("can not resolve type alias ".concat(e.name," ").concat(e.type));var m=function(t){c(n,t);var r=u(n);function n(t){var a;return s(this,n),(a=r.call(this,t))._type=e.name,a._typeResolver=l,a}return n}(v);Object.assign(r,i({},e.name,m))}})),Object.assign(r,t),r},t.buildTypeResolver=m}).call(this,r(9))},123:function(e,t){},189:function(e,t,r){"use strict";(function(e){var n=r(37),a=r(38);Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeState=t.serializeState=t.STATE_LEN_4BYTES=t.STATE_LEN_2BYTES=void 0;var i=r(24),o=i.bsv.Script,c=i.bsv.Opcode,u=i.bsv.crypto.BN;function s(e){return e?"OP_TRUE":"OP_FALSE"}function l(e){var t=new u(e);return t.eqn(0)?"00":t.toSM({endian:"little"}).toString("hex")}function p(t){return""===t?"00":e.from(t,"utf8").toString("hex")}function f(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=r[t];return"boolean"===n?s(e[t]):"number"===n||"bigint"===n?l(e[t]):"string"===n?p(e[t]):e[t]}function y(e){return"boolean"===typeof e?s(e):"number"===typeof e||"bigint"===typeof e?l(e):e}t.STATE_LEN_2BYTES=2,t.STATE_LEN_4BYTES=4,t.serializeState=function(e){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.STATE_LEN_2BYTES,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=[],c=Object.keys(e),u=0,s=c;u<s.length;u++){var l=s[u];if(n){var p=f(e,l,n);a.push(p)}else{var h=y(e[l]);a.push(h)}}var d=o.fromASM(a.join(" ")),b=d.toHex(),g=b.length/2,v=i.num2bin(g,r);return d.toASM()+" "+v};var h=function(){function e(t){n(this,e),this.op=t}return a(e,[{key:"toNumber",value:function(){return Number(this.toBigInt())}},{key:"toBigInt",value:function(){if(this.op.opcodenum===c.OP_1)return BigInt(1);if(this.op.opcodenum===c.OP_0)return BigInt(0);if(this.op.opcodenum===c.OP_1NEGATE)return BigInt(-1);if(this.op.opcodenum>=c.OP_2&&this.op.opcodenum<=c.OP_16)return BigInt(this.op.opcodenum-c.OP_2+2);if(!this.op.buf)throw new Error("state does not have a number representation");return i.bin2num(this.op.buf)}},{key:"toBoolean",value:function(){return this.toBigInt()!==BigInt(0)}},{key:"toHex",value:function(){if(!this.op.buf)throw new Error("state does not have a hexadecimal representation");return this.op.buf.toString("hex")}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf8";if(!this.op.buf)throw new Error("state does not have a string representation");return 0===this.op.buf[0]?"":this.op.buf.toString(e)}}]),e}();t.deserializeState=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;try{t=new o(e)}catch(b){t=o.fromASM(e)}for(var n,a=t.chunks,i=[],u=a.length,s=u-2;s>=0;s--){var l=a[s].opcodenum;if(l===c.OP_RETURN)break;i.unshift(new h(a[s]))}if(!r)return i;n=Array.isArray(r)?[]:{};for(var p=Object.keys(r),f=0;f<i.length;f++){var y=p[f];if(!y)break;var d=r[y];n[y]="boolean"===d||"boolean"===typeof d?i[f].toBoolean():"number"===d||"number"===typeof d?i[f].toNumber():"bigint"===d||"bigint"===typeof d?i[f].toBigInt():"string"===d?i[f].toString():i[f].toHex()}return n}}).call(this,r(1).Buffer)},2:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(111);Object.defineProperty(t,"buildContractClass",{enumerable:!0,get:function(){return n.buildContractClass}}),Object.defineProperty(t,"buildTypeClasses",{enumerable:!0,get:function(){return n.buildTypeClasses}}),Object.defineProperty(t,"buildStructsClass",{enumerable:!0,get:function(){return n.buildStructsClass}}),Object.defineProperty(t,"buildTypeResolver",{enumerable:!0,get:function(){return n.buildTypeResolver}});var a=r(67);Object.defineProperty(t,"compile",{enumerable:!0,get:function(){return a.compile}}),Object.defineProperty(t,"getStructDeclaration",{enumerable:!0,get:function(){return a.getStructDeclaration}}),Object.defineProperty(t,"getABIDeclaration",{enumerable:!0,get:function(){return a.getABIDeclaration}}),Object.defineProperty(t,"ABIEntityType",{enumerable:!0,get:function(){return a.ABIEntityType}});var i=r(24);Object.defineProperty(t,"bsv",{enumerable:!0,get:function(){return i.bsv}}),Object.defineProperty(t,"signTx",{enumerable:!0,get:function(){return i.signTx}}),Object.defineProperty(t,"toHex",{enumerable:!0,get:function(){return i.toHex}}),Object.defineProperty(t,"getPreimage",{enumerable:!0,get:function(){return i.getPreimage}}),Object.defineProperty(t,"num2bin",{enumerable:!0,get:function(){return i.num2bin}}),Object.defineProperty(t,"bin2num",{enumerable:!0,get:function(){return i.bin2num}}),Object.defineProperty(t,"bool2Asm",{enumerable:!0,get:function(){return i.bool2Asm}}),Object.defineProperty(t,"int2Asm",{enumerable:!0,get:function(){return i.int2Asm}}),Object.defineProperty(t,"parseLiteral",{enumerable:!0,get:function(){return i.parseLiteral}}),Object.defineProperty(t,"bytes2Literal",{enumerable:!0,get:function(){return i.bytes2Literal}}),Object.defineProperty(t,"bytesToHexString",{enumerable:!0,get:function(){return i.bytesToHexString}}),Object.defineProperty(t,"getValidatedHexString",{enumerable:!0,get:function(){return i.getValidatedHexString}}),Object.defineProperty(t,"literal2ScryptType",{enumerable:!0,get:function(){return i.literal2ScryptType}}),Object.defineProperty(t,"literal2Asm",{enumerable:!0,get:function(){return i.literal2Asm}}),Object.defineProperty(t,"findStructByType",{enumerable:!0,get:function(){return i.findStructByType}}),Object.defineProperty(t,"findStructByName",{enumerable:!0,get:function(){return i.findStructByName}}),Object.defineProperty(t,"isStructType",{enumerable:!0,get:function(){return i.isStructType}}),Object.defineProperty(t,"isArrayType",{enumerable:!0,get:function(){return i.isArrayType}}),Object.defineProperty(t,"compileContract",{enumerable:!0,get:function(){return i.compileContract}}),Object.defineProperty(t,"arrayTypeAndSize",{enumerable:!0,get:function(){return i.arrayTypeAndSize}}),Object.defineProperty(t,"newCall",{enumerable:!0,get:function(){return i.newCall}}),Object.defineProperty(t,"getStructNameByType",{enumerable:!0,get:function(){return i.getStructNameByType}}),Object.defineProperty(t,"genLaunchConfigFile",{enumerable:!0,get:function(){return i.genLaunchConfigFile}}),Object.defineProperty(t,"subArrayType",{enumerable:!0,get:function(){return i.subArrayType}});var o=r(189);Object.defineProperty(t,"serializeState",{enumerable:!0,get:function(){return o.serializeState}}),Object.defineProperty(t,"deserializeState",{enumerable:!0,get:function(){return o.deserializeState}}),Object.defineProperty(t,"STATE_LEN_2BYTES",{enumerable:!0,get:function(){return o.STATE_LEN_2BYTES}}),Object.defineProperty(t,"STATE_LEN_4BYTES",{enumerable:!0,get:function(){return o.STATE_LEN_4BYTES}});var c=r(66);Object.defineProperty(t,"Int",{enumerable:!0,get:function(){return c.Int}}),Object.defineProperty(t,"Bool",{enumerable:!0,get:function(){return c.Bool}}),Object.defineProperty(t,"Bytes",{enumerable:!0,get:function(){return c.Bytes}}),Object.defineProperty(t,"PrivKey",{enumerable:!0,get:function(){return c.PrivKey}}),Object.defineProperty(t,"PubKey",{enumerable:!0,get:function(){return c.PubKey}}),Object.defineProperty(t,"Sig",{enumerable:!0,get:function(){return c.Sig}}),Object.defineProperty(t,"Ripemd160",{enumerable:!0,get:function(){return c.Ripemd160}}),Object.defineProperty(t,"Sha1",{enumerable:!0,get:function(){return c.Sha1}}),Object.defineProperty(t,"Sha256",{enumerable:!0,get:function(){return c.Sha256}}),Object.defineProperty(t,"SigHashType",{enumerable:!0,get:function(){return c.SigHashType}}),Object.defineProperty(t,"SigHashPreimage",{enumerable:!0,get:function(){return c.SigHashPreimage}}),Object.defineProperty(t,"OpCodeType",{enumerable:!0,get:function(){return c.OpCodeType}}),Object.defineProperty(t,"ScryptType",{enumerable:!0,get:function(){return c.ScryptType}}),Object.defineProperty(t,"Struct",{enumerable:!0,get:function(){return c.Struct}}),Object.defineProperty(t,"VariableType",{enumerable:!0,get:function(){return c.VariableType}});var u=r(374);Object.defineProperty(t,"web3",{enumerable:!0,get:function(){return u.web3}}),Object.defineProperty(t,"wallet",{enumerable:!0,get:function(){return u.wallet}}),Object.defineProperty(t,"LocalWallet",{enumerable:!0,get:function(){return u.LocalWallet}}),Object.defineProperty(t,"NetWork",{enumerable:!0,get:function(){return u.NetWork}}),Object.defineProperty(t,"SignType",{enumerable:!0,get:function(){return u.SignType}})},210:function(e,t,r){},212:function(e,t,r){},219:function(e,t,r){"use strict";var n=r(119),a=r(53),i=r(37),o=r(38);Object.defineProperty(t,"__esModule",{value:!0}),t.ABICoder=t.FunctionCall=void 0;var c=r(120),u=r(24),s=r(66),l=r(67);function p(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var f=function(){function e(t,r,n){if(i(this,e),this.methodName=t,this.params=r,this.args=[],void 0===n.lockingScriptASM&&void 0===n.unlockingScriptASM)throw new Error("param binding.lockingScriptASM & binding.unlockingScriptASM cannot both be empty");this.contract=n.contract,this.args=Object.getPrototypeOf(this.contract).constructor.abi.filter((function(e){return"constructor"===t?"constructor"===e.type:e.name===t})).map((function(e){return e.params.map((function(e,t){return{name:e.name,type:e.type,value:r[t]}}))})).flat(1),n.lockingScriptASM&&(this._lockingScriptAsm=n.lockingScriptASM),n.unlockingScriptASM&&(this._unlockingScriptAsm=n.unlockingScriptASM)}return o(e,[{key:"unlockingScript",get:function(){return void 0===this._unlockingScriptAsm?void 0:u.bsv.Script.fromASM(this._unlockingScriptAsm)}},{key:"lockingScript",get:function(){return void 0===this._lockingScriptAsm?void 0:u.bsv.Script.fromASM(this._lockingScriptAsm)}},{key:"init",value:function(e){for(var t in e){var r=e[t],n=new RegExp("\\$".concat(t),"g");this._lockingScriptAsm=this._lockingScriptAsm.replace(n,r)}}},{key:"toASM",value:function(){return this.lockingScript?this.lockingScript.toASM():this.unlockingScript.toASM()}},{key:"toString",value:function(){return this.toHex()}},{key:"toScript",value:function(){return u.bsv.Script.fromASM(this.toASM())}},{key:"toHex",value:function(){return this.toScript().toHex()}},{key:"genLaunchConfigFile",value:function(e){var t=this.contract.scriptedConstructor.params,r=this.params,n=this.methodName,a="Debug ".concat(Object.getPrototypeOf(this.contract).constructor.contractName),i="".concat(Object.getPrototypeOf(this.contract).constructor.file),o=this.contract.asmArgs||{},c=this.contract.dataPart?this.contract.dataPart.toASM():"",s=Object.assign({},this.contract.txContext||{},e||{},{opReturn:c});return u.genLaunchConfigFile(t,r,n,a,i,s,o)}},{key:"verify",value:function(e){if(this.unlockingScript){var t=this.contract.run_verify(this.unlockingScript.toASM(),e);if(!t.success){var r=this.genLaunchConfigFile(e);r&&u.printDebugUri()&&(t.error=t.error+"\t[Launch Debugger](".concat(r.replace(/file:/i,"scryptlaunch:"),")\n"))}return t}return{success:!1,error:"verification failed, missing unlockingScript"}}}]),e}();t.FunctionCall=f;var y=function(){function e(t,r){i(this,e),this.abi=t,this.alias=r}return o(e,[{key:"encodeConstructorCall",value:function(e,t){for(var r=this,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];var s=this.abi.filter((function(e){return e.type===l.ABIEntityType.CONSTRUCTOR}))[0],y=c.oc(s).params([]);if(i.length!==y.length)throw new Error("wrong number of arguments for #constructor, expected ".concat(y.length," but got ").concat(i.length));var h=[],d=[];y.forEach((function(e,t){var n=i[t],o=u.resolveType(r.alias,e.type);if(u.isArrayType(o)){var c=u.arrayTypeAndSize(o),s=a(c,2),l=s[0],p=s[1];if(!Array.isArray(n))throw new Error("constructor ".concat(t,"-th parameter should be ").concat(o));if(!u.checkArray(n,[l,p]))throw new Error("constructor ".concat(t,"-th parameter should be ").concat(o));u.flatternArray(n,e.name,o).forEach((function(e,t){h.push({name:e.name,type:e.type}),d.push(e.value)}))}else if(u.isStructType(o)){var f=n;if(o!=f.finalType)throw new Error("expect struct ".concat(e.type," but got struct ").concat(f.type));u.flatternStruct(f,e.name).forEach((function(e){h.push({name:"".concat(e.name),type:e.type}),d.push(e.value)}))}else h.push(e),d.push(n)}));var b=t;return h.forEach((function(e,n){if(!t.includes("$".concat(e.name)))throw new Error("abi constructor params mismatch with args provided: missing ".concat(e.name," in ASM tempalte"));var a=new RegExp(p("$".concat(e.name)),"g");b=b.replace(a,r.encodeParam(d[n],e))})),new f("constructor",i,{contract:e,lockingScriptASM:b})}},{key:"encodeConstructorCallFromASM",value:function(e,t){return new f("constructor",[],{contract:e,lockingScriptASM:t})}},{key:"encodePubFunctionCall",value:function(e,t,r){var a,i=n(this.abi);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(o.name===t){if(o.params.length!==r.length)throw new Error("wrong number of arguments for #".concat(t,", expected ").concat(o.params.length," but got ").concat(r.length));var c=this.encodeParams(r,o.params);if(this.abi.length>2&&void 0!==o.index){var s=o.index;c+=" ".concat(u.int2Asm(s.toString()))}return new f(t,r,{contract:e,unlockingScriptASM:c})}}}catch(l){i.e(l)}finally{i.f()}throw new Error("no function named '".concat(t,"' found in abi"))}},{key:"encodeParams",value:function(e,t){var r=this;return e.map((function(e,n){return r.encodeParam(e,t[n])})).join(" ")}},{key:"encodeParamArray",value:function(e,t){var r=this;if(0===e.length)throw new Error("Empty array not allowed");var n=typeof e[0];if(!e.every((function(e){return typeof e===n})))throw new Error("Array arguments are not of the same type");var i=u.resolveType(this.alias,t.type),o=u.arrayTypeAndSize(i),c=a(o,2),s=c[0],l=c[1];if(u.checkArray(e,[s,l]))return u.flatternArray(e,t.name,i).map((function(e){return r.encodeParam(e.value,{name:e.name,type:e.type})})).join(" ");throw new Error("checkArray ".concat(t.type," fail"))}},{key:"encodeParam",value:function(e,t){var r=u.resolveType(this.alias,t.type);if(u.isArrayType(r)){if(Array.isArray(e))return this.encodeParamArray(e,t);var n=u.typeOfArg(e);throw new Error("expect param ".concat(t.name," as ").concat(r," but got ").concat(n))}if(u.isStructType(r)){if(!s.Struct.isStruct(e)){var a=e.type;throw new Error("expect param ".concat(t.name," as struct ").concat(u.getStructNameByType(t.type)," but got ").concat(a))}var i=e;if(r!=i.finalType)throw new Error("expect struct ".concat(t.type," but got struct ").concat(i.type))}var o=u.typeOfArg(e);if(o!=r)throw new Error("wrong argument type, expected ".concat(r," or ").concat(t.type," but got ").concat(o));var c=typeof e;return"boolean"===c&&(e=new s.Bool(e)),"number"===c&&(e=new s.Int(e)),"bigint"===c&&(e=new s.Int(e)),e.toASM()}}]),e}();t.ABICoder=y},232:function(e,t){},239:function(e,t){},24:function(e,t,r){"use strict";(function(e,n,a){var i=r(86),o=r(53);Object.defineProperty(t,"__esModule",{value:!0}),t.printDebugUri=t.resolveType=t.genLaunchConfigFile=t.newCall=t.compileContract=t.getCIScryptc=t.isEmpty=t.readFileByLine=t.typeOfArg=t.flatternStruct=t.flatternArray=t.subscript=t.checkArray=t.subArrayType=t.toLiteralArrayType=t.arrayTypeAndSize=t.arrayTypeAndSizeStr=t.checkStruct=t.findStructByType=t.getStructNameByType=t.isArrayType=t.isStructType=t.findStructByName=t.literal2Asm=t.uri2path=t.path2uri=t.bin2num=t.num2bin=t.getPreimage=t.toHex=t.signTx=t.getValidatedHexString=t.hexStringToBytes=t.bytesToHexString=t.bytes2Literal=t.literal2ScryptType=t.parseLiteral=t.intValue2hex=t.int2Value=t.int2Asm=t.bool2Asm=t.DEFAULT_SIGHASH_TYPE=t.DEFAULT_FLAGS=t.bsv=void 0;var c=r(223),u=r(66),s=r(67),l=r(237);t.bsv=l;var p=r(123),f=r(122),y=r(373),h=r(124),d=l.crypto.BN,b=l.Script.Interpreter;function g(e){if(/^(-?\d+)$/.test(e)||/^0x([0-9a-fA-F]+)$/.test(e)){var t=e.startsWith("0x")?new d(e.substring(2),16):new d(e,10);return t.eqn(-1)?"OP_1NEGATE":t.gten(0)&&t.lten(16)?"OP_"+e:t.toSM({endian:"little"}).toString("hex")}throw new Error("invalid str '".concat(e,"' to convert to int"))}function v(e){if(/^(-?\d+)$/.test(e)||/^0x([0-9a-fA-F]+)$/.test(e)){var t=e.startsWith("0x")?new d(e.substring(2),16):new d(e,10);return t.toNumber()<Number.MAX_SAFE_INTEGER?t.toNumber():BigInt(e)}throw new Error("invalid str '".concat(e,"' to convert to int"))}function m(e){if("false"===e)return["OP_FALSE",!1,u.VariableType.BOOL];if("true"===e)return["OP_TRUE",!0,u.VariableType.BOOL];var t=/^(0x[0-9a-fA-F]+)$/.exec(e);if(t)return[g(t[1]),v(t[1]),u.VariableType.INT];if(t=/^(-?\d+)$/.exec(e))return[g(t[1]),v(t[1]),u.VariableType.INT];if(t=/^b'([\da-fA-F]*)'$/.exec(e)){var r=x(t[1]);return[""===r?"OP_0":r,r,u.VariableType.BYTES]}if(t=/^PrivKey\((-?\d+)\)$/.exec(e))return[t[1],v(t[1]),u.VariableType.PRIVKEY];if(t=/^PrivKey\((0x[0-9a-fA-F]+)\)$/.exec(e))return[t[1],v(t[1]),u.VariableType.PRIVKEY];if(t=/^PubKey\(b'([\da-fA-F]+)'\)$/.exec(e)){var n=x(t[1]);return[n,n,u.VariableType.PUBKEY]}if(t=/^Sig\(b'([\da-fA-F]+)'\)$/.exec(e)){var a=x(t[1]);return[a,a,u.VariableType.SIG]}if(t=/^Ripemd160\(b'([\da-fA-F]+)'\)$/.exec(e)){var i=x(t[1]);return[i,i,u.VariableType.RIPEMD160]}if(t=/^Sha1\(b'([\da-fA-F]+)'\)$/.exec(e)){var o=x(t[1]);return[o,o,u.VariableType.SHA1]}if(t=/^Sha256\(b'([\da-fA-F]+)'\)$/.exec(e)){var c=x(t[1]);return[c,c,u.VariableType.SHA256]}if(t=/^SigHashType\(b'([\da-fA-F]+)'\)$/.exec(e)){var s=new d(x(t[1]),16);return[s.toString("hex",2),s.toNumber(),u.VariableType.SIGHASHTYPE]}if(t=/^SigHashPreimage\(b'([\da-fA-F]+)'\)$/.exec(e)){var l=x(t[1]);return[l,l,u.VariableType.SIGHASHPREIMAGE]}if(t=/^OpCodeType\(b'([\da-fA-F]+)'\)$/.exec(e)){var p=x(t[1]);return[p,p,u.VariableType.OPCODETYPE]}if(t=/^\{([\w(){}[\],\s']+)\}$/.exec(e))return["","",u.VariableType.STRUCT];throw new Error("<".concat(e,"> cannot be cast to ASM format, only sCrypt native types supported"))}function S(e){return e.reduce((function(e,t){return e+("0"+(255&t).toString(16)).slice(-2)}),"")}function x(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.trim();if(r.length<1&&!t)throw new Error("can't be empty string");if(r.length%2)throw new Error("".concat(r," should have even length"));if(r.length>0&&!/^[\da-f]+$/i.test(r))throw new Error("".concat(r," should only contain [0-9] or characters [a-fA-F]"));return r}function w(e){return c.pathToFileURL(e).toString()}function A(e,t){return t.find((function(t){return t.name==e}))}function O(e){return/^struct\s(\w+)\s\{\}$/.test(e)}function T(e){return/^\w[\w.\s{}]+(\[[\w.]+\])+$/.test(e)}function P(e){var t=/^struct\s(\w+)\s\{\}$/.exec(e.trim());return t?t[1]:""}function j(e){var t=[];return i(e.matchAll(/\[([\w.]+)\]+/g)).map((function(e){t.push(e[1])})),[e.split("[")[0],t]}function E(e){var t=j(e),r=o(t,2);return[r[0],r[1].map((function(e){return parseInt(e)}))]}function k(e,t){return[e,t.map((function(e){return"[".concat(e,"]")})).join("")].join("")}function I(e){var t=E(e),r=o(t,2);return k(r[0],r[1].slice(1))}function N(e,t){var r=o(t,2),n=r[0],a=r[1];if(!Array.isArray(e))return!1;var i=a[0];return!!i&&(e.length===i&&!!e.every((function(e){return Array.isArray(e)?N(e,[n,a.slice(1)]):B(e)===n&&1==a.length})))}function _(e,t){if(1==t.length)return"[".concat(e,"]");if(t.length>1){var r=t.slice(1),n=r.reduce((function(e,t){return e*t}),1);return"[".concat(Math.floor(e/n),"]").concat(_(e%n,r))}}function C(e,t,r){if(!Array.isArray(e))throw new Error("flatternArray only work on array");var n=E(r),a=o(n,2),i=a[0],c=a[1];return e.map((function(e,n){if("boolean"===typeof e)e=new u.Bool(e);else if("number"===typeof e)e=new u.Int(e);else if("bigint"===typeof e)e=new u.Int(e);else{if(Array.isArray(e))return C(e,"".concat(t,"[").concat(n,"]"),I(r));if(u.Struct.isStruct(e))return L(e,"".concat(t,"[").concat(n,"]"));e=e}return{value:e,name:"".concat(t).concat(_(n,c)),type:i}})).flat(1/0)}function L(e,t){if(u.Struct.isStruct(e)){var r=e;return r.getMembers().map((function(e){var n=r.memberByKey(e);if(u.Struct.isStruct(n))return L(n,"".concat(t,".").concat(e));if(Array.isArray(n)){var a=r.getMemberAstFinalType(e);return C(n,"".concat(t,".").concat(e),a)}return{value:n=n,name:"".concat(t,".").concat(e),type:n.type}})).flat(1/0)}throw new Error("".concat(e," should be struct"))}function B(e){if(e instanceof u.ScryptType)return e.finalType;var t=typeof e;return"boolean"===t?"bool":"number"===t||"bigint"===t?"int":typeof e}function H(e){return 0===Object.keys(e).length&&e.constructor===Object}function R(t){t||(t=f.dirname(e.parent.filename));var r=f.resolve(t,"compiler");if(p.existsSync(r)&&p.statSync(r).isDirectory())return f.join(r,"..",s.getPlatformScryptc());var n=f.resolve(t,"..");return n!==t?R(n):void 0}function F(){var e=R(n);return p.existsSync(e)?e:void 0}t.DEFAULT_FLAGS=b.SCRIPT_ENABLE_MAGNETIC_OPCODES|b.SCRIPT_ENABLE_MONOLITH_OPCODES|b.SCRIPT_VERIFY_STRICTENC|b.SCRIPT_ENABLE_SIGHASH_FORKID|b.SCRIPT_VERIFY_LOW_S|b.SCRIPT_VERIFY_NULLFAIL|b.SCRIPT_VERIFY_DERSIG|b.SCRIPT_VERIFY_MINIMALDATA|b.SCRIPT_VERIFY_NULLDUMMY|b.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS|b.SCRIPT_VERIFY_CHECKLOCKTIMEVERIFY|b.SCRIPT_VERIFY_CHECKSEQUENCEVERIFY,t.DEFAULT_SIGHASH_TYPE=l.crypto.Signature.SIGHASH_ALL|l.crypto.Signature.SIGHASH_FORKID,t.bool2Asm=function(e){if("true"===e)return"OP_TRUE";if("false"===e)return"OP_FALSE";throw new Error("invalid str '".concat(e,"' to convert to bool"))},t.int2Asm=g,t.int2Value=v,t.intValue2hex=function(e){var t=e.toString(16);return t.length%2===1&&(t="0"+t),t},t.parseLiteral=m,t.literal2ScryptType=function(e){var t=m(e),r=o(t,3),n=(r[0],r[1]);switch(r[2]){case u.VariableType.BOOL:return new u.Bool(n);case u.VariableType.INT:return new u.Int(n);case u.VariableType.BYTES:return new u.Bytes(n);case u.VariableType.PRIVKEY:return new u.PrivKey(n);case u.VariableType.PUBKEY:return new u.PubKey(n);case u.VariableType.SIG:return new u.Sig(n);case u.VariableType.RIPEMD160:return new u.Ripemd160(n);case u.VariableType.SHA1:return new u.Sha1(n);case u.VariableType.SHA256:return new u.Sha256(n);case u.VariableType.SIGHASHTYPE:return new u.SigHashType(n);case u.VariableType.SIGHASHPREIMAGE:return new u.SigHashPreimage(n);case u.VariableType.OPCODETYPE:return new u.OpCodeType(n);default:throw new Error("<".concat(e,"> cannot be cast to ScryptType, only sCrypt native types supported"))}},t.bytes2Literal=function(e,t){switch(t){case"bool":return d.fromBuffer(e,{endian:"little"})>0?"true":"false";case"int":return d.fromSM(e,{endian:"little"}).toString();case"bytes":default:return"b'".concat(S(e),"'")}},t.bytesToHexString=S,t.hexStringToBytes=function(e){return x(e),e.split("").reduce((function(e,t,r){return r%2===0?e.push(t):e[e.length-1]+=t,e}),new Array).map((function(e){return parseInt(e,16)}))},t.getValidatedHexString=x,t.signTx=function(e,r,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:t.DEFAULT_SIGHASH_TYPE,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t.DEFAULT_FLAGS;if(!e)throw new Error("param tx can not be empty");if(!r)throw new Error("param privateKey can not be empty");if(!n)throw new Error("param lockingScriptASM can not be empty");if(!a)throw new Error("param inputAmount can not be empty");return l.Transaction.sighash.sign(e,r,o,i,l.Script.fromASM(n),new l.crypto.BN(a),c).toTxFormat()},t.toHex=function(e){return e.toString("hex")},t.getPreimage=function(e,r,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.DEFAULT_SIGHASH_TYPE,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:t.DEFAULT_FLAGS,c=l.Transaction.sighash.sighashPreimage(e,i,a,l.Script.fromASM(r),new l.crypto.BN(n),o);return new u.SigHashPreimage(c.toString("hex"))},t.num2bin=function(e,t){var r=new d(e);if(r.eqn(0))return"00".repeat(t);var n=r.toSM({endian:"little"}).toString("hex"),a=n.length/2;if(a>t)throw new Error("".concat(e," cannot fit in ").concat(t," byte[s]"));if(a===t)return n;var i=t-a,o=n.substring(n.length-2),c=n.substring(0,n.length-2),u=parseInt(o,16);r.isNeg&&(u&=127);var s=u.toString(16);return s.length<2&&(s="0"+s),c+s+(e>0?"00".repeat(i):"00".repeat(i-1)+"80")},t.bin2num=function(e){var t=e.toString("hex"),r=t.substring(t.length-2),n=t.substring(0,t.length-2),a=parseInt(r,16),i=(127&a).toString(16);i.length<2&&(i="0"+i);var o=d.fromHex(n+i,{endian:"little"});return a>>7&&(o=o.neg()),BigInt(o)},t.path2uri=w,t.uri2path=function(e){return c.fileURLToPath(e)},t.literal2Asm=function(e){var t=m(e),r=o(t,3),n=r[0];return r[1],[n,r[2]]},t.findStructByName=A,t.isStructType=O,t.isArrayType=T,t.getStructNameByType=P,t.findStructByType=function(e,t){var r=P(e);if(r)return A(r,t)},t.checkStruct=function(e,t,r){e.params.forEach((function(n){var a=B(t.memberByKey(n.name)),i=r(n.type);if("undefined"===a)throw new Error("argument of type struct ".concat(e.name," missing member ").concat(n.name));if(a!=i){if(!T(i))throw new Error("wrong argument type, expected ".concat(i," but got ").concat(a));var c=E(i),u=o(c,2),s=u[0],l=u[1];if(!Array.isArray(t.value[n.name]))throw new Error("struct ".concat(e.name," property ").concat(n.name," should be ").concat(i));if(!N(t.value[n.name],[s,l]))throw new Error("checkArray fail, struct ".concat(e.name," property ").concat(n.name," should be ").concat(i))}}));var n=e.params.map((function(e){return e.name}));t.getMembers().forEach((function(t){if(!n.includes(t))throw new Error("".concat(t," is not a member of struct ").concat(e.name))}))},t.arrayTypeAndSizeStr=j,t.arrayTypeAndSize=E,t.toLiteralArrayType=k,t.subArrayType=I,t.checkArray=N,t.subscript=_,t.flatternArray=C,t.flatternStruct=L,t.typeOfArg=B,t.readFileByLine=function(e,t){var r="";return p.readFileSync(e,"utf8").split(/\r?\n/).every((function(e,n){return n!==t-1||(r=e,!1)})),r},t.isEmpty=H,t.getCIScryptc=F,t.compileContract=function(e,t){if(console.log("Compiling contract ".concat(e," ...")),!p.existsSync(e))throw"file ".concat(e," not exists!");var r=y(a.argv.slice(2)),i=r.scryptc;return!r.ci&&i||(i=F()),s.compile({path:e},{desc:!0,debug:!0,sourceMap:!0,outputDir:t||f.join(n,"../out"),cmdPrefix:i})},t.newCall=function(e,t){return new(Function.prototype.bind.apply(e,[null].concat(t)))},t.genLaunchConfigFile=function(e,t,r,n,i,o,c){if(!i)return"";var u={type:"scrypt",request:"launch",internalConsoleOptions:"openOnSessionStart",name:n,program:i,constructorArgs:e,pubFunc:r,pubFuncArgs:t},s={};if(!H(o)){var l=o.tx||"",y=o.inputIndex||0,d=o.inputSatoshis||0;l&&Object.assign(s,{hex:l.toString(),inputIndex:y,inputSatoshis:d}),o.opReturn&&Object.assign(s,{opReturn:o.opReturn})}H(c)||Object.assign(u,{asmArgs:c}),H(s)||Object.assign(u,{txContext:s});var b={version:"0.2.0",configurations:[u]};if("object"!==typeof a)return console.error("DebugConfiguration",JSON.stringify(b)),"";var g="".concat(n,"-launch.json"),v=f.join(p.mkdtempSync("".concat(h.tmpdir()).concat(f.sep,"sCrypt.")),g);return p.writeFileSync(v,JSON.stringify(b,(function(e,t){return"bigint"===typeof t?t.toString():t}),2)),w(v)},t.resolveType=function e(t,r){if(T(r)){var n=E(r),a=o(n,2),i=a[0],c=a[1];return k(e(t,i),c)}if(O(r))return e(t,P(r));var s=t.find((function(e){return e.name===r}));return s?e(t,s.type):u.BasicType.indexOf(r)>-1?r:"struct ".concat(r," {}")},t.printDebugUri=function(){return!0===y(a.argv.slice(2)).debugUri}}).call(this,r(25)(e),"/",r(9))},247:function(e,t){},270:function(e,t){},272:function(e,t){},283:function(e,t){},285:function(e,t){},312:function(e,t){},314:function(e,t){},315:function(e,t){},320:function(e,t){},322:function(e,t){},341:function(e,t){},353:function(e,t){},356:function(e,t){},374:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(375);Object.defineProperty(t,"web3",{enumerable:!0,get:function(){return n.web3}});var a=r(110);Object.defineProperty(t,"wallet",{enumerable:!0,get:function(){return a.wallet}}),Object.defineProperty(t,"NetWork",{enumerable:!0,get:function(){return a.NetWork}}),Object.defineProperty(t,"SignType",{enumerable:!0,get:function(){return a.SignType}});var i=r(393);Object.defineProperty(t,"LocalWallet",{enumerable:!0,get:function(){return i.LocalWallet}})},375:function(e,t,r){"use strict";var n=r(10),a=r(190),i=r(37),o=r(38);Object.defineProperty(t,"__esModule",{value:!0}),t.web3=void 0;var c=r(111),u=r(110),s=r(24),l=r(191),p="0.0.1",f=1e3,y=function(){function e(){i(this,e)}return o(e,null,[{key:"setWallet",value:function(t){e.wallet=t}},{key:"version",value:function(){return p}},{key:"loadContract",value:function(e){return l.default.get(e,{timeout:1e4}).then((function(e){return 200===e.status?{contractClass:c.buildContractClass(e.data),types:c.buildTypeClasses(e.data)}:null}))}},{key:"buildDeployTx",value:function(){var t=a(n.mark((function t(r,i){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.buildUnsignDeployTx(r,i).then(function(){var t=a(n.mark((function t(r){var a;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.wallet.signTx(r,0,u.SignType.ALL);case 2:return a=t.sent,r.inputs[0].script=a,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"appendPayInput",value:function(){var t=a(n.mark((function t(r,i){var o;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.wallet.changeAddress();case 2:return o=t.sent,t.abrupt("return",e.wallet.queryUtxos(i+f,{purpose:"change"}).then(function(){var t=a(n.mark((function t(a){var c,l,p;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==a.length){t.next=2;break}throw new Error("no utxos");case 2:return c=r.inputs.length,r.inputs.push({utxo:a[0],script:"",sequence:0}),l=a[0].satoshis-i-f,r.outputs.push({script:s.bsv.Script.buildPublicKeyHashOut(o).toHex(),satoshis:l}),t.next=8,e.wallet.signTx(r,c,u.SignType.ALL);case 8:return p=t.sent,r.inputs[c].script=p,t.abrupt("return",r);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 4:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"buildUnsignDeployTx",value:function(){var t=a(n.mark((function t(r,i){var o;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.wallet.changeAddress();case 2:return o=t.sent,t.abrupt("return",e.wallet.queryUtxos(i+f,{purpose:"change"}).then(function(){var e=a(n.mark((function e(t){var a,c,u;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}throw new Error("no utxos");case 2:return a={inputs:[],outputs:[]},c={utxo:t[0],sequence:0,script:""},a.inputs.push(c),a.outputs.push({script:r.lockingScript.toHex(),satoshis:i}),u=t[0].satoshis-i-f,a.outputs.push({script:s.bsv.Script.buildPublicKeyHashOut(o).toHex(),satoshis:u}),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"getPreimage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.SignType.ALL,n=u.wallet.toBsvTx(e);return s.getPreimage(n,s.bsv.Script.fromHex(e.inputs[t].utxo.script).toASM(),e.inputs[t].utxo.satoshis,t,r)}},{key:"sendRawTx",value:function(){var t=a(n.mark((function t(r){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.wallet.sendTx(r));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"sendTx",value:function(){var t=a(n.mark((function t(r){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.wallet.sendTx(u.wallet.toHexBsvTx(r)));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"deploy",value:function(){var t=a(n.mark((function t(r,i){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.buildDeployTx(r,i).then(function(){var t=a(n.mark((function t(r){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.sendTx(r));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"call",value:function(e,t,r){return null}}]),e}();t.web3=y,console.log("hello, this is scryptlib web3 ".concat(p,"."))},393:function(e,t,r){"use strict";var n=r(10),a=r(190),i=r(37),o=r(38),c=r(65),u=r(85);Object.defineProperty(t,"__esModule",{value:!0}),t.LocalWallet=void 0;var s=r(110),l=r(24),p=r(394),f=r(191),y=function(e){c(r,e);var t=u(r);function r(e,n){var a;return i(this,r),(a=t.call(this,e)).API_PREFIX="https://api.whatsonchain.com/v1/bsv/".concat(e==s.NetWork.Testnet?"test":"main"),a.privKey=n?new l.bsv.PrivateKey.fromWIF(n):new l.bsv.PrivateKey.fromRandom(e),a}return o(r,[{key:"requestAccount",value:function(e,t){throw new Error("Method not implemented.")}},{key:"balance",value:function(){var e=a(n.mark((function e(){var t,r;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.default.get("".concat(this.API_PREFIX,"/address/").concat(this.privKey.toAddress(),"/balance"),{timeout:5e3});case 2:return t=e.sent,r=t.data,e.abrupt("return",r.confirmed+r.unconfirmed);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signTx",value:function(){var e=a(n.mark((function e(t,r,a){var i,o,c,u=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=u.length>3&&void 0!==u[3]&&u[3],o=s.wallet.toBsvTx(t),c=t.inputs[r].utxo,!i){e.next=5;break}return e.abrupt("return",l.signTx(o,this.privKey,o.inputs[r].output.script.toASM(),o.inputs[r].output.satoshisBN,r,a));case 5:return e.abrupt("return",p.signInput(this.privKey,o,r,a,c));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"sendTx",value:function(){var e=a(n.mark((function e(t){var r,a,i,o;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Math.max(1,t.length/2/1024),a=Math.max(1e4,1e3*r),e.next=4,f.default.post("".concat(this.API_PREFIX,"/tx/raw"),{txhex:t},{timeout:a});case 4:return i=e.sent,o=i.data,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queryUtxos",value:function(){var e=a(n.mark((function e(t,r){var a=this;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f.default.get("".concat(this.API_PREFIX,"/address/").concat(this.privKey.toAddress(),"/unspent"),{timeout:1e4}).then((function(e){return e.data.filter((function(e){return e.value>=t})).map((function(e){return{txHash:e.tx_hash,outputIndex:e.tx_pos,satoshis:e.value,script:l.bsv.Script.buildPublicKeyHashOut(a.privKey.toAddress()).toHex()}}))})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"changeAddress",value:function(e){var t=this;return new Promise((function(e){return e(t.privKey.toAddress()+"")}))}},{key:"publicKey",value:function(e){var t=this;return new Promise((function(e){return e(l.toHex(t.privKey.publicKey))}))}}]),r}(s.wallet);t.LocalWallet=y},394:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.signInput=void 0;var n=r(24);t.signInput=function(e,t,r,a,i){t.inputs[r].output=new n.bsv.Transaction.Output({script:i.script,satoshis:i.satoshis});var o=new n.bsv.Transaction.Signature({publicKey:e.publicKey,prevTxId:i.txHash,outputIndex:i.outputIndex,inputIndex:r,signature:n.bsv.Transaction.Sighash.sign(t,e,a,r,t.inputs[r].output.script,t.inputs[r].output.satoshisBN),sigtype:a});return n.bsv.Script.buildPublicKeyHashIn(o.publicKey,o.signature.toDER(),o.sigtype).toHex()}},405:function(e,t,r){"use strict";r.r(t);var n=r(7),a=r.n(n),i=r(204),o=r.n(i),c=(r(210),r(10)),u=r.n(c),s=r(23),l=r(36),p=(r(212),r(49)),f=r(50),y=r(52),h=r(51),d=r(0),b=function(e){var t=e.value?"https://test.whatsonchain.com/tx/".concat(e.value.tx):"";return Object(d.jsx)("button",{className:"".concat(e.winnerClass," square"),onClick:e.onClick,children:e.value?Object(d.jsx)("a",{href:t,target:"_blank",title:"Click to see the transaction",children:e.value.label}):e.value})},g=function(e){Object(y.a)(r,e);var t=Object(h.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return Object(f.a)(r,[{key:"createBoard",value:function(e,t){for(var r=[],n=0,a=0;a<e;a+=1){for(var i=[],o=0;o<t;o+=1)i.push(this.renderSquare(n++));r.push(Object(d.jsx)("div",{className:"board-row",children:i},a))}return r}},{key:"renderSquare",value:function(e){var t=this,r=!this.props.winnerSquares||this.props.winnerSquares[0]!==e&&this.props.winnerSquares[1]!==e&&this.props.winnerSquares[2]!==e?"":"square--green";return Object(d.jsx)(b,{winnerClass:r,value:this.props.squares[e],onClick:function(){return t.props.onClick(e)}},e)}},{key:"render",value:function(){return Object(d.jsx)("div",{children:this.createBoard(3,3)})}}]),r}(a.a.Component),v=r(2),m=r(81),S=(r(395),new(function(e){Object(y.a)(r,e);var t=Object(h.a)(r);function r(){var e;Object(p.a)(this,r),(e=t.call(this)).player="",e.privKey="",e.existGamebySelf=function(){var t=window.localStorage.getItem("game");if(t&&null!==t&&(t=JSON.parse(t)).creator&&t.creator===e.player)return t},e.existGamebyOther=function(){var t=window.localStorage.getItem("game");if(t&&null!==t&&(t=JSON.parse(t)).creator&&t.creator!==e.player)return t},e.deleteGame=function(){console.log("deleteGame"),window.localStorage.removeItem("game")},e.createGame=function(e){return e.event="createGame",console.log("createGame",e),window.localStorage.setItem("game",JSON.stringify(e))},e.JoinGame=function(e){e.event="JoinGame",console.log("JoinGame",e),window.localStorage.setItem("game",JSON.stringify(e))},e.saveGame=function(e,t){e.event=t,console.log("saveGame",e),window.localStorage.setItem("game",JSON.stringify(e))},e.getGame=function(){var e=window.localStorage.getItem("game");if(e&&null!==e)return JSON.parse(e)},e.getIdentity=function(){return e.player},e.savePrivateKey=function(t){e.privKey=t,window.localStorage.setItem(e.player,t)},e.getPrivateKey=function(){return e.player&&(e.privKey=window.localStorage.getItem(e.player)),e.privKey};var n=new URLSearchParams(window.location.search);e.player=n.get("player")||"alice";var a=Object(m.a)(e);return window.addEventListener("storage",(function(t){if(console.log("on storage change "+e.player,t),"game"===t.key)try{var r=window.localStorage.getItem("game");if(r&&null!==r){var n=JSON.parse(r);n.event&&a.emit(n.event,n)}}catch(t){console.error(" storage change error",t)}}),!1),e}return Object(f.a)(r,[{key:"addJoinListener",value:function(e){console.log("addJoinListener"),this.on("JoinGame",e)}},{key:"removeJoinListener",value:function(e){console.log("removeJoinListener"),this.off("JoinGame",e)}},{key:"addAliceSignListener",value:function(e){console.log("addAliceSignListener"),this.on("AliceSign",e)}},{key:"removeAliceSignListener",value:function(e){console.log("removeAliceSignListener"),this.off("AliceSign",e)}},{key:"addDeployedListener",value:function(e){console.log("addDeployedListener"),this.on("deployed",e)}},{key:"removeDeployedListener",value:function(e){console.log("removeDeployedListener"),this.off("deployed",e)}},{key:"addNextListener",value:function(e){console.log("addNextListener"),this.on("next",e)}},{key:"removeNextListener",value:function(e){console.log("removeNextListener"),this.off("next",e)}}]),r}(r(42).EventEmitter))),x=function(e){for(var t=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]],r=0;r<t.length;r+=1){var n=Object(l.a)(t[r],3),a=n[0],i=n[1],o=n[2];if(e[a]&&e[i]&&e[o]&&e[a].label===e[i].label&&e[a].label===e[o].label)return{winner:e[a],winnerRow:t[r]}}return{winner:null,winnerRow:null}},w={history:[{squares:Array(9).fill(null)}],currentStepNumber:0,xIsNext:!0},A=function(e){Object(y.a)(r,e);var t=Object(h.a)(r);function r(e){var n;return Object(p.a)(this,r),n=t.call(this,e),console.log("Game constructor",e.game),e.game&&e.game.gameState?n.state=e.game.gameState:n.state=w,n}return Object(f.a)(r,[{key:"componentWillReceiveProps",value:function(e){console.log("componentWillReceiveProps",e),e.game&&e.game.gameState?this.setState(e.game.gameState):this.setState(w)}},{key:"componentDidMount",value:function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("componentDidMount",this.props);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){}},{key:"handleClick",value:function(){var e=Object(s.a)(u.a.mark((function e(t){var r,n,a,i,o,c,s,l,p,f,y,h,d,b,g,m,w,A=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.game&&this.props.game.lastUtxo){e.next=3;break}return console.error("handleClick error",this.props.game),e.abrupt("return");case 3:if(r=this.state.history.slice(0,this.state.currentStepNumber+1),n=r[r.length-1],a=n.squares.slice(),!x(a).winner&&!a[t]){e.next=8;break}return e.abrupt("return");case 8:if(a[t]={label:this.state.xIsNext?"X":"O"},"alice"!==(i=S.getIdentity())||!this.state.xIsNext){e.next=13;break}e.next=19;break;case 13:if("bob"!==i||this.state.xIsNext){e.next=16;break}e.next=19;break;case 16:return alert("now is ".concat(this.state.xIsNext?"alice":"bob"," turn ")),console.error("now is ".concat(this.state.xIsNext?"alice":"bob"," turn , but got ").concat(i)),e.abrupt("return");case 19:if(o=(this.state.xIsNext?"01":"00")+a.map((function(e){return e&&"X"===e.label?"01":e&&"O"===e.label?"02":"00"})).join(""),c="",s=x(a).winner,l=2e3,p=[],f=this.props.game.lastUtxo.satoshis-l,!s){e.next=33;break}return e.next=28,v.web3.wallet.changeAddress();case 28:y=e.sent,c=v.bsv.Script.buildPublicKeyHashOut(y).toHex(),p.push({satoshis:f,script:c}),e.next=34;break;case 33:r.length>=9?(h=new v.bsv.PublicKey(this.props.game.alicePubKey,{network:v.bsv.Networks.testnet}),d=new v.bsv.PublicKey(this.props.game.bobPubKey,{network:v.bsv.Networks.testnet}),console.log("aliceAddress="+h.toAddress(v.bsv.Networks.testnet)),console.log("bobAddress="+d.toAddress(v.bsv.Networks.testnet)),b=v.bsv.Script.buildPublicKeyHashOut(h.toAddress(v.bsv.Networks.testnet)).toHex(),g=v.bsv.Script.buildPublicKeyHashOut(d.toAddress(v.bsv.Networks.testnet)).toHex(),f=(this.props.game.lastUtxo.satoshis-l)/2,p.push({satoshis:f,script:b}),p.push({satoshis:f,script:g})):(c=[this.props.contractInstance.codePart.toHex(),v.bsv.Script.fromASM(o).toHex()].join(""),p.push({satoshis:f,script:c}));case 34:m={inputs:[{utxo:this.props.game.lastUtxo,sequence:0,script:""}],outputs:p},w=v.web3.getPreimage(m),v.web3.wallet.signTx(m,0,v.SignType.ALL,!0).then((function(e){var n=A.props.contractInstance.move(t,new v.Sig(Object(v.toHex)(e)),f,w).toHex();m.inputs[0].script=n,v.web3.sendTx(m).then((function(e){a[t].tx=e;var n,i={history:r.concat([{squares:a,currentLocation:(n=t,{0:"row: 1, col: 1",1:"row: 1, col: 2",2:"row: 1, col: 3",3:"row: 2, col: 1",4:"row: 2, col: 2",5:"row: 2, col: 3",6:"row: 3, col: 1",7:"row: 3, col: 2",8:"row: 3, col: 3"}[n]),stepNumber:r.length}]),xIsNext:!A.state.xIsNext,currentStepNumber:r.length};S.saveGame(Object.assign({},A.props.game,{gameState:i,lastUtxo:{txHash:e,outputIndex:0,satoshis:m.outputs[0].satoshis,script:m.outputs[0].script}}),"next"),A.setState(i)}))}));case 37:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,r,n=this,a=this.state.history,i=a[this.state.currentStepNumber],o=x(i.squares),c=o.winner,u=o.winnerRow,s=S.getGame();return s&&s.deploy&&(r=Object(d.jsxs)("div",{className:"bet",children:[Object(d.jsx)("a",{href:"https://test.whatsonchain.com/tx/".concat(s.deploy),target:"_blank",children:"Bet transaction"})," "]})),c?(e="Winner ".concat("X"===c.label?"Alice":"Bob"),s&&s.lastUtxo&&(t=Object(d.jsxs)("div",{className:"end",children:[Object(d.jsx)("a",{href:"https://test.whatsonchain.com/tx/".concat(s.lastUtxo.txHash),target:"_blank",children:"Withdraw transaction"})," "]}))):10===a.length?(e="Draw. No one won.",s&&s.lastUtxo&&(t=Object(d.jsxs)("div",{className:"end",children:[Object(d.jsx)("a",{href:"https://test.whatsonchain.com/tx/".concat(s.lastUtxo.txHash),target:"_blank",children:"Withdraw transaction"})," "]}))):e="Next player: ".concat(this.state.xIsNext?"Alice":"Bob"),Object(d.jsx)("div",{className:"game",children:Object(d.jsxs)("div",{className:"game-board",children:[Object(d.jsxs)("div",{className:"game-status",children:[" ",e," "]}),Object(d.jsx)(g,{squares:i.squares,winnerSquares:u,onClick:function(e){return n.handleClick(e)}}),Object(d.jsxs)("div",{className:"game-title",children:[r,t]})]})})}}]),r}(a.a.Component);var O=function(e){a.a.useReducer((function(e){return!e}))[1];var t=Object(n.useRef)(null),r=function(t){e.cancelBet()};return Object(n.useEffect)((function(){})),e.started?Object(d.jsxs)("div",{children:["The game is in progress ...",Object(d.jsx)("button",{className:"pure-button cancel",onClick:r,children:"Cancel"})]}):S.existGamebySelf()?Object(d.jsxs)("div",{children:["Waiting  Bob join the game ...",Object(d.jsx)("a",{className:"pure-button",href:window.location.href+"?player=bob",target:"_blank",children:" Join"}),Object(d.jsx)("button",{className:"pure-button cancel",onClick:r,children:"Cancel"})]}):S.existGamebyOther()?Object(d.jsx)("div",{children:"Joining the game..."}):Object(d.jsxs)("div",{children:[Object(d.jsxs)("label",{children:["Bet amount:",Object(d.jsx)("input",{ref:t,type:"text",name:"amount"})]}),Object(d.jsx)("button",{className:"start",onClick:function(r){v.web3.wallet||alert("Pelease create wallet first");var n=parseInt(t.current.value);isNaN(n)?console.error("".concat(t.current.value," is not number")):e.startBet(n)},children:"Start Bet"})]})},T=r(205);var P=function(e){var t=Object(n.useState)(""),r=Object(l.a)(t,2),a=r[0],i=r[1],o=Object(n.useState)(0),c=Object(l.a)(o,2),u=c[0],s=c[1];Object(n.useEffect)((function(){v.web3.wallet?(v.web3.wallet.changeAddress().then((function(e){i(e)})),v.web3.wallet.balance().then((function(e){s(e)}))):S.getPrivateKey()&&(v.web3.setWallet(new v.LocalWallet(v.NetWork.Testnet,S.getPrivateKey())),e.updateWallet())})),function(e,t){var r=Object(n.useRef)();Object(n.useEffect)((function(){r.current=e})),Object(n.useEffect)((function(){var e=setInterval((function(){r.current()}),t);return function(){return clearInterval(e)}}),[t])}((function(){v.web3.wallet&&v.web3.wallet.balance().then((function(e){console.log("update balance old: ".concat(u," new: ").concat(e)),0===u&&e>0&&alert("Successfully deposit, try F5 to reload the page"),s(e)}))}),5e3);return v.web3.wallet?Object(d.jsxs)("div",{className:"wallet",children:[Object(d.jsxs)("div",{className:"walletInfo",children:[Object(d.jsx)("div",{className:"address",children:Object(d.jsxs)("label",{children:["Address: ",a]})}),Object(d.jsx)("div",{className:"balance",children:Object(d.jsxs)("label",{children:["Balance: ",u]})}),Object(d.jsx)("div",{className:"fundtips",children:Object(d.jsxs)("label",{children:["You can fund the address with ",Object(d.jsx)("a",{href:"https://faucet.bitcoincloud.net",target:"_blank",children:Object(d.jsx)("span",{children:" faucets"})})]})})]}),Object(d.jsx)("div",{className:"walletqrcode",children:Object(d.jsx)(T,{value:a})})]}):Object(d.jsx)("div",{className:"wallet",children:Object(d.jsx)("button",{className:"pure-button button-large",onClick:function(t){try{var r=new v.bsv.PrivateKey.fromRandom("testnet");v.web3.setWallet(new v.LocalWallet(v.NetWork.Testnet,r.toWIF())),S.savePrivateKey(r.toWIF()),e.updateWallet()}catch(t){console.log("wallet onChange error",t)}},children:"Create Wallet"})})};var j=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),r=t[0],i=t[1],o=Object(n.useState)(null),c=Object(l.a)(o,2),p=c[0],f=c[1],y=a.a.useReducer((function(e){return!e}))[1],h=function(){var e=Object(s.a)(u.a.mark((function e(t){var r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("startBet with amount",t),"bob"!==S.getIdentity()){e.next=4;break}return alert("Only alice can start bet"),e.abrupt("return");case 4:if(!v.web3.wallet){e.next=16;break}return e.next=7,v.web3.wallet.balance();case 7:if(r=e.sent,!(t>r)){e.next=11;break}return alert("Please fund your wallet address first"),e.abrupt("return");case 11:return e.next=13,v.web3.wallet.publicKey();case 13:n=e.sent,S.createGame({amount:t,tx:{inputs:[],outputs:[]},name:"tic-tac-toe",alicePubKey:n,bobPubKey:"",creator:"alice",player:"",date:new Date}),y();case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(s.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("onBobJoin",t),"alice"!==t.creator||"alice"!==S.getIdentity()){e.next=9;break}return e.next=4,v.web3.appendPayInput(t.tx,t.amount);case 4:r=e.sent,t.tx=r,S.saveGame(t,"AliceSign"),e.next=10;break;case 9:i(!0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(s.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("alice"!==t.creator||"bob"!==S.getIdentity()){e.next=7;break}return console.log("onAliceSign",t),e.next=4,v.web3.wallet.signTx(t.tx,0,v.SignType.ALL);case 4:r=e.sent,t.tx.inputs[0].script=r,v.web3.sendTx(t.tx).then((function(e){t.lastUtxo={txHash:e,outputIndex:0,satoshis:t.tx.outputs[0].satoshis,script:t.tx.outputs[0].script},t.deploy=e,S.saveGame(t,"deployed"),i(!0)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(s.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"alice"===t.creator&&"alice"===S.getIdentity()&&null===p&&(console.log("onDeployed",t),w(t),i(!0));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(s.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("onNext",t),y();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function w(e){return T.apply(this,arguments)}function T(){return(T=Object(s.a)(u.a.mark((function e(t){var r,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===p&&t&&t.bobPubKey&&t.alicePubKey)){e.next=10;break}return e.next=3,v.web3.loadContract("/tic-tac-toe/tictactoe_desc.json");case 3:return r=e.sent,n=r.contractClass,(a=Object(v.newCall)(n,[new v.PubKey(Object(v.toHex)(t.alicePubKey)),new v.PubKey(Object(v.toHex)(t.bobPubKey))])).setDataPart(t.state?t.state:"00000000000000000000"),console.log("fetchContract",a),f(a),e.abrupt("return",a);case 10:return console.log("fetchContract null"),e.abrupt("return",p);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(n.useEffect)((function(){var e=S.getGame();function t(){return(t=Object(s.a)(u.a.mark((function e(t){var r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.web3.wallet.publicKey();case 2:return r=e.sent,e.next=5,v.web3.wallet.balance();case 5:if(!(e.sent<=t.amount)){e.next=9;break}return alert("no available utxos or  balance is not enough, please fund your wallet"),e.abrupt("return");case 9:return t=Object.assign(t,{bobPubKey:r,player:"Bob"}),e.next=12,w(t);case 12:n=e.sent,console.log("bobJoin fetchContract",n),null!=n&&v.web3.buildUnsignDeployTx(n,t.amount).then((function(e){e.outputs[0].satoshis=2*t.amount,S.JoinGame(Object.assign(t,{tx:e}))})).catch((function(e){"no utxos"===e.message&&alert("no available utxos, please fund your wallet"),console.error("buildUnsignDeployTx error",e)}));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return e&&e.lastUtxo&&i(!0),"bob"===S.getIdentity()&&e&&!e.deploy?v.web3.wallet?function(e){t.apply(this,arguments)}(e):setTimeout((function(){alert("Please create your wallet and fund it")}),1e3):w(e),S.addJoinListener(b),S.addAliceSignListener(g),S.addDeployedListener(m),S.addNextListener(x),function(){S.removeAliceSignListener(g),S.removeDeployedListener(m),S.removeJoinListener(b),S.removeNextListener(x)}}),[p]);var j=S.getGame();return Object(d.jsxs)("div",{className:"App",children:[Object(d.jsx)(P,{updateWallet:function(){console.log("updateWallet"),y()}}),Object(d.jsxs)("header",{className:"App-header",children:[Object(d.jsx)("h2",{children:"sCrypt dapp tic-tac-toe"}),Object(d.jsx)(O,{startBet:h,cancelBet:function(){S.deleteGame(),i(!1),y()},started:r,game:j}),Object(d.jsx)(A,{game:j,contractInstance:p})]})]})},E=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,406)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;r(e),n(e),a(e),i(e),o(e)}))};o.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(j,{})}),document.getElementById("root")),E()},66:function(e,t,r){"use strict";(function(e){var n,a=r(115),i=r(65),o=r(85),c=r(53),u=r(37),s=r(38);Object.defineProperty(t,"__esModule",{value:!0}),t.BasicScryptType=t.BasicType=t.VariableType=t.Struct=t.OpCodeType=t.SigHashPreimage=t.SigHashType=t.SigHash=t.Sha256=t.Sha1=t.Ripemd160=t.Sig=t.PubKey=t.PrivKey=t.Bytes=t.Bool=t.Int=t.ScryptType=t.toScryptType=void 0;var l=r(24);function p(e){if("number"===typeof e||"bigint"===typeof e)return new y(e);if("boolean"===typeof e)return new h(e);if(e instanceof f)return e;throw"".concat(e," cannot be convert to ScryptType")}t.toScryptType=p;var f=function(){function e(t){u(this,e);try{this._value=t,this._literal=this.toLiteral();var r=l.parseLiteral(this._literal),n=c(r,3),a=n[0],i=(n[1],n[2]);this._type=i,this._asm=a}catch(o){throw new Error("can't get type from ".concat(this._literal,", ").concat(o.message))}}return s(e,[{key:"value",get:function(){return this._value}},{key:"finalType",get:function(){return this._typeResolver?this._typeResolver(this.type):this.type}},{key:"literal",get:function(){return this._literal}},{key:"type",get:function(){return this._type}},{key:"toASM",value:function(){return this._asm}},{key:"toJSON",value:function(){return this.toLiteral()}},{key:"toLiteral",value:function(){return""}}]),e}();t.ScryptType=f;var y=function(e){i(r,e);var t=o(r);function r(e){return u(this,r),t.call(this,e)}return s(r,[{key:"toLiteral",value:function(){return this._value.toString()}}]),r}(f);t.Int=y;var h=function(e){i(r,e);var t=o(r);function r(e){return u(this,r),t.call(this,e)}return s(r,[{key:"toLiteral",value:function(){return this._value.toString()}}]),r}(f);t.Bool=h;var d=function(e){i(r,e);var t=o(r);function r(e){return u(this,r),t.call(this,e)}return s(r,[{key:"toLiteral",value:function(){return"b'".concat(l.getValidatedHexString(this._value.toString()),"'")}}]),r}(f);t.Bytes=d;var b=function(e){i(r,e);var t=o(r);function r(e){return u(this,r),t.call(this,e)}return s(r,[{key:"toLiteral",value:function(){var e=this._value;return"PrivKey(0x".concat(l.intValue2hex(e),")")}}]),r}(f);t.PrivKey=b;var g=function(e){i(r,e);var t=o(r);function r(e){return u(this,r),t.call(this,e)}return s(r,[{key:"toLiteral",value:function(){return"PubKey(b'".concat(l.getValidatedHexString(this._value.toString()),"')")}}]),r}(f);t.PubKey=g;var v=function(e){i(r,e);var t=o(r);function r(e){return u(this,r),t.call(this,e)}return s(r,[{key:"toLiteral",value:function(){return"Sig(b'".concat(l.getValidatedHexString(this._value.toString()),"')")}}]),r}(f);t.Sig=v;var m=function(e){i(r,e);var t=o(r);function r(e){return u(this,r),t.call(this,e)}return s(r,[{key:"toLiteral",value:function(){return"Ripemd160(b'".concat(l.getValidatedHexString(this._value.toString()),"')")}}]),r}(f);t.Ripemd160=m;var S=function(e){i(r,e);var t=o(r);function r(e){return u(this,r),t.call(this,e)}return s(r,[{key:"toLiteral",value:function(){return"Sha1(b'".concat(l.getValidatedHexString(this._value.toString()),"')")}}]),r}(f);t.Sha1=S;var x,w=function(e){i(r,e);var t=o(r);function r(e){return u(this,r),t.call(this,e)}return s(r,[{key:"toLiteral",value:function(){return"Sha256(b'".concat(l.getValidatedHexString(this._value.toString()),"')")}}]),r}(f);t.Sha256=w,function(e){e[e.ALL=1]="ALL",e[e.NONE=2]="NONE",e[e.SINGLE=3]="SINGLE",e[e.FORKID=64]="FORKID",e[e.ANYONECANPAY=128]="ANYONECANPAY"}(x=t.SigHash||(t.SigHash={}));var A=function(e){i(r,e);var t=o(r);function r(e){return u(this,r),t.call(this,e)}return s(r,[{key:"toLiteral",value:function(){var e=this._value.toString(16);return e.length%2&&(e="0"+e),"SigHashType(b'".concat(e,"')")}},{key:"toString",value:function(){var e=[],t=this._value;if((t&x.ANYONECANPAY)===x.ANYONECANPAY&&(e.push("SigHash.ANYONECANPAY"),t-=x.ANYONECANPAY),(t&x.SINGLE)===x.SINGLE&&(e.push("SigHash.SINGLE"),t-=x.SINGLE),(t&x.NONE)===x.NONE&&(e.push("SigHash.NONE"),t-=x.NONE),(t&x.ALL)===x.ALL&&(e.push("SigHash.ALL"),t-=x.ALL),(t&x.FORKID)===x.FORKID&&(e.push("SigHash.FORKID"),t-=x.FORKID),0===t)return e.join(" | ");throw new Error("unknown sighash type value: ".concat(this._value))}}]),r}(f);t.SigHashType=A;var O=function(t){i(n,t);var r=o(n);function n(t){var a;return u(this,n),(a=r.call(this,t))._buf=e.from(t,"hex"),a}return s(n,[{key:"getReader",value:function(e){return new l.bsv.encoding.BufferReader(e)}},{key:"nVersion",get:function(){return this.getReader(this._buf.slice(0,4)).readUInt32LE()}},{key:"hashPrevouts",get:function(){return this._buf.slice(4,36).toString("hex")}},{key:"hashSequence",get:function(){return this._buf.slice(36,68).toString("hex")}},{key:"outpoint",get:function(){var t=this._buf.slice(68,104),r=t.toString("hex"),n=this.getReader(t.slice(32,36)).readUInt32LE();return{hash:e.from(t.slice(0,32)).reverse().toString("hex"),index:n,hex:r}}},{key:"scriptCode",get:function(){return this.getReader(this._buf.slice(104,this._buf.length-52)).readVarLengthBuffer().toString("hex")}},{key:"amount",get:function(){return this.getReader(this._buf.slice(this._buf.length-44-8,this._buf.length-44)).readUInt32LE()}},{key:"nSequence",get:function(){return this.getReader(this._buf.slice(this._buf.length-40-4,this._buf.length-40)).readUInt32LE()}},{key:"hashOutputs",get:function(){return this._buf.slice(this._buf.length-8-32,this._buf.length-8).toString("hex")}},{key:"nLocktime",get:function(){return this.getReader(this._buf.slice(this._buf.length-4-4,this._buf.length-4)).readUInt32LE()}},{key:"sighashType",get:function(){return this.getReader(this._buf.slice(this._buf.length-4,this._buf.length)).readUInt32LE()}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"hex";return this._buf.toString(e)}},{key:"toLiteral",value:function(){return"SigHashPreimage(b'".concat(l.getValidatedHexString(this._value.toString()),"')")}},{key:"toJSONObject",value:function(){return{nVersion:this.nVersion,hashPrevouts:this.hashPrevouts,hashSequence:this.hashSequence,outpoint:this.outpoint,scriptCode:this.scriptCode,amount:this.amount,nSequence:this.nSequence,hashOutputs:this.hashOutputs,nLocktime:this.nLocktime,sighashType:new A(this.sighashType).toString()}}}]),n}(f);t.SigHashPreimage=O;var T=function(e){i(r,e);var t=o(r);function r(e){return u(this,r),t.call(this,e)}return s(r,[{key:"toLiteral",value:function(){return"OpCodeType(b'".concat(l.getValidatedHexString(this._value.toString()),"')")}}]),r}(f);t.OpCodeType=T;var P,j=function(e){i(r,e);var t=o(r);function r(e){var n;return u(this,r),(n=t.call(this,e)).sorted=!1,n}return s(r,[{key:"bind",value:function(){var e=Object.getPrototypeOf(this).constructor.structAst;l.checkStruct(e,this,this._typeResolver);var t={},r=this.value;Object.keys(this.value).sort((function(t,r){return e.params.findIndex((function(e){return e.name===t}))-e.params.findIndex((function(e){return e.name===r}))})).forEach((function(e){t[e]=r[e]})),this.sorted=!0,this._type=e.name,this._value=t}},{key:"toASM",value:function(){if(!this.sorted)throw"unbinded Struct can't call toASM";return this._asm=l.flatternStruct(this,"").map((function(e){return e.value.toASM()})).join(" "),this._asm}},{key:"toArray",value:function(){if(!this.sorted)throw"unbinded Struct can't call toArray";var e=this.value;return Object.keys(e).map((function(t){return e[t]instanceof f?e[t]:"boolean"===typeof e[t]?new h(e[t]):"number"===typeof e[t]||"bigint"===typeof e[t]?new y(e[t]):void 0}))}},{key:"memberByIndex",value:function(e){if(!this.sorted)throw"unbinded Struct can't call memberByIndex";var t=this.value;return Object.keys(t)[e]}},{key:"getMemberType",value:function(e){var t=this.value;return t[e]instanceof f?t[e].type:"boolean"===typeof t[e]?new h(t[e]).type:"number"===typeof t[e]||"bigint"===typeof t[e]?new y(t[e]).type:typeof t[e]}},{key:"getMemberFinalType",value:function(e){var t=this.memberByKey(e);return l.typeOfArg(t)}},{key:"getMemberAstFinalType",value:function(e){var t=Object.getPrototypeOf(this).constructor.structAst,r=t.params.find((function(t){return t.name===e}));if(!r)throw new Error("".concat(e," is member of struct ").concat(t.name));return this._typeResolver(r.type)}},{key:"getMembers",value:function(){var e=this.value;return Object.keys(e)}},{key:"memberByKey",value:function(e){var t=this.value;return t[e]instanceof f?t[e]:"boolean"===typeof t[e]?new h(t[e]):"number"===typeof t[e]||"bigint"===typeof t[e]?new y(t[e]):t[e]}},{key:"toLiteral",value:function(){var e=this.value,t=Object.keys(this.value).map((function(t){return Array.isArray(e[t])?r.arrayToLiteral(e[t]):p(e[t]).toLiteral()})).join(",");return"{".concat(t,"}")}},{key:"toJSON",value:function(){var e=this.value;return Array.from(Object.keys(e)).reduce((function(t,n){return e[n]instanceof f?r.isStruct(e[n])?Object.assign(t,a({},n,e[n].toJSON())):Array.isArray(e[n])?Object.assign(t,a({},n,JSON.stringify(e[n]))):Object.assign(t,a({},n,e[n].toLiteral())):Object.assign(t,a({},n,e[n]))}),{})}}],[{key:"arrayToLiteral",value:function(e){var t=e.map((function(e){return Array.isArray(e)?r.arrayToLiteral(e):p(e).toLiteral()})).join(",");return"[".concat(t,"]")}},{key:"isStruct",value:function(e){return e instanceof r}}]),r}(f);t.Struct=j,function(e){e.BOOL="bool",e.INT="int",e.BYTES="bytes",e.PUBKEY="PubKey",e.PRIVKEY="PrivKey",e.SIG="Sig",e.RIPEMD160="Ripemd160",e.SHA1="Sha1",e.SHA256="Sha256",e.SIGHASHTYPE="SigHashType",e.SIGHASHPREIMAGE="SigHashPreimage",e.OPCODETYPE="OpCodeType",e.STRUCT="struct"}(P=t.VariableType||(t.VariableType={})),t.BasicType=Object.keys(P).map((function(e){return P[e]})),t.BasicScryptType=(a(n={},P.BOOL,h),a(n,P.INT,y),a(n,P.BYTES,d),a(n,P.PUBKEY,g),a(n,P.PRIVKEY,b),a(n,P.SIG,v),a(n,P.RIPEMD160,m),a(n,P.SHA1,S),a(n,P.SHA256,w),a(n,P.SIGHASHTYPE,A),a(n,P.OPCODETYPE,T),a(n,P.SIGHASHPREIMAGE,O),n)}).call(this,r(1).Buffer)},67:function(e,t,r){"use strict";var n=r(53),a=r(86),i=r(231);Object.defineProperty(t,"__esModule",{value:!0}),t.desc2CompileResult=t.getDefaultScryptc=t.getPlatformScryptc=t.getStaticConstIntDeclaration=t.getAliasDeclaration=t.getStructDeclaration=t.resolveArrayTypeWithConstInt=t.getABIDeclaration=t.compilerVersion=t.compile=t.ABIEntityType=t.DebugModeTag=t.CompileErrorType=void 0;var o,c,u,s=r(122),l=r(232),p=r(123),f=r(120),y=r(124),h=r(233),d=r(24),b=r(236),g=i(/((?:(?![\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])[\s\S])+):([0-9]+):([0-9]+):\n((?:(?!\n)[\s\S])+\n){3}(unexpected ((?:(?!\n)[\s\S])+)\nexpecting ((?:(?!\n)[\s\S])+)|((?:(?!\n)[\s\S])+))/g,{filePath:1,line:2,column:3,unexpected:6,expecting:7,message:8}),v=i(/Error:([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]|\n)*((?:(?![\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])[\s\S])+):([0-9]+):([0-9]+):([0-9]+):([0-9]+):*\n((?:(?!\n)[\s\S])+)\n/g,{filePath:2,line:3,column:4,line1:5,column1:6,message:7}),m=i(/Internal error:(.+)/,{message:1}),S=i(/^(\x2D?[0-9]+):([0-9]+):([0-9]+):([0-9]+):([0-9]+)(#(.+))?/,{fileIndex:1,line:2,col:3,endLine:4,endCol:5,tagStr:7});function x(e){var t=l.execSync("".concat(e," version")).toString();return/Version:\s*([^\s]+)\s*/.exec(t)[1]}function w(e,t,r){for(var n in e)if("std"===n)e.std=A(e.std,"std");else{var a="stdin"===n?r:n,i=d.path2uri(s.join(t,a));e[i]=A(e[n],i),delete e[n]}return e}function A(e,t){if(!(e instanceof Object))return e;for(var r in e){var n=e[r];if("src"===r){var a=/:(\d+):(\d+):(\d+):(\d+)/.exec(n);e.loc=a?{source:t,start:{line:parseInt(a[1]),column:parseInt(a[2])},end:{line:parseInt(a[3]),column:parseInt(a[4])}}:null,delete e.src}else n instanceof Object&&A(n,t)}return e}function O(e,t){return s.join(e,"stdin_".concat(t,".json"))}function T(e,t,r){return e.endsWith("stdin")?s.join(t,r):"std"===e?"std":s.join(t,e)}function P(e,t,r){var n=e.contracts[e.contracts.length-1],a=function(e){var t=0;return e.functions.filter((function(e){return"Public"===e.visibility})).map((function(e){return{type:u.FUNCTION,name:e.name,index:"Constructor"===e.nodeType?void 0:t++,params:e.params.map((function(e){return{name:e.name,type:e.type}}))}}))}(n),i=function(e){return e.constructor?{type:u.CONSTRUCTOR,params:e.constructor.params.map((function(e){return{name:e.name,type:e.type}}))}:e.properties?{type:u.CONSTRUCTOR,params:e.properties.map((function(e){return{name:e.name.replace("this.",""),type:e.type}}))}:void 0}(n);return a.push(i),a.forEach((function(e){e.params=e.params.map((function(e){return Object.assign(e,{type:j(n.name,e.type,t,r)})}))})),{contract:n.name,abi:a}}function j(e,t,r,a){var i=E(e,t,a),o=d.resolveType(r,i);if(d.isStructType(o))return d.getStructNameByType(o);if(d.isArrayType(o)){var c=d.arrayTypeAndSize(o),u=n(c,2),s=u[0],l=u[1],p=d.isStructType(s)?d.getStructNameByType(s):s;return d.toLiteralArrayType(p,l)}return o}function E(e,t,r){if(d.isArrayType(t)){var a=d.arrayTypeAndSizeStr(t),i=n(a,2),o=i[0],c=i[1].map((function(t){return/^(\d)+$/.test(t)?parseInt(t):t.indexOf(".")>0?r[t]:r["".concat(e,".").concat(t)]}));return d.toLiteralArrayType(o,c)}return t}function k(e,t){var r=[e];return Object.keys(t).forEach((function(e){r.push(t[e])})),r.map((function(e){return f.oc(e).structs([]).map((function(e){return{name:e.name,params:e.fields.map((function(e){return{name:e.name,type:e.type}}))}}))})).flat(1)}function I(e,t){var r=[e];return Object.keys(t).forEach((function(e){r.push(t[e])})),r.map((function(e){return f.oc(e).alias([]).map((function(e){return{name:e.alias,type:e.type}}))})).flat(1)}function N(e,t){var r=[e];return Object.keys(t).forEach((function(e){r.push(t[e])})),r.map((function(e,t){return f.oc(e).contracts([]).map((function(e){return f.oc(e).statics([]).filter((function(e){return!0===e.const&&"IntLiteral"===e.expr.nodeType})).map((function(t){return{name:"".concat(e.name,".").concat(t.name),value:t.expr.value}}))}))})).flat(1/0).reduce((function(e,t){return e[t.name]=t.value,e}),{})}function _(){switch(y.platform()){case"win32":return"compiler/scryptc/win32/scryptc.exe";case"linux":return"compiler/scryptc/linux/scryptc";case"darwin":return"compiler/scryptc/mac/scryptc";default:throw"sCrypt doesn't support ".concat(y.platform())}}function C(){var e=function(){var e=y.homedir(),t=s.join(e,".vscode/extensions");if(!p.existsSync(t))throw"No Visual Studio Code extensions found. Please ensure Visual Studio Code is installed.";return t}(),t=function(e){var t="bsv-scrypt.scrypt-",r=p.readdirSync(e).reduce((function(e,r){if(r.indexOf(t)>-1){var n=r.substring(t.length);b.validate(n)&&e.push(n)}return e}),[]);return r=r.sort(b).reverse(),t+r[0]}(e);if(!t)throw"No sCrypt extension found. Please install it at extension marketplace:\n\t\thttps://marketplace.visualstudio.com/items?itemName=bsv-scrypt.sCrypt";var r=s.join(e,t,_());if(!p.existsSync(r))throw"No sCrypt compiler found. Please update your sCrypt extension to the latest version";return r}!function(e){e.SyntaxError="SyntaxError",e.SemanticError="SemanticError",e.InternalError="InternalError"}(o=t.CompileErrorType||(t.CompileErrorType={})),function(e){e.FuncStart="F0",e.FuncEnd="F1",e.LoopStart="L0"}(c=t.DebugModeTag||(t.DebugModeTag={})),function(e){e.FUNCTION="function",e.CONSTRUCTOR="constructor"}(u=t.ABIEntityType||(t.ABIEntityType={})),t.compile=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{asm:!0,debug:!0,optimize:!1},r=(Date.now(),e.path),n=s.dirname(r),i=t.cwd||n,u=s.basename(r),y=t.outputDir||n,b=t.timeout||12e5,A={};try{var j=void 0!==e.content?e.content:p.readFileSync(r,"utf8"),E=t.cmdPrefix||C(),_="".concat(E," compile ").concat(t.asm||t.desc?"--asm":""," ").concat(t.ast||t.desc?"--ast":""," ").concat(0==t.debug?"":"--debug"," ").concat(t.optimize?"--opt":"",' -r -o "').concat(y,'" ').concat(t.cmdArgs?t.cmdArgs:""),L=l.execSync(_,{input:j,cwd:i,timeout:b}).toString();if((L=L.split(/\r?\n/g).join("\n")).startsWith("Error:")){if(L.match(m))return{errors:[{type:o.InternalError,filePath:T("stdin",n,u),message:"Compiler internal error: ".concat(f.oc(L.match(m).groups).message("")),position:[{line:1,column:1},{line:1,column:1}]}]};if(L.includes("Syntax error:")){var B=a(L.matchAll(g)).map((function(e){var t=f.oc(e.groups).filePath(""),r=f.oc(e.groups).unexpected(""),a=f.oc(e.groups).expecting("");return{type:o.SyntaxError,filePath:T(t,n,u),position:[{line:parseInt(f.oc(e.groups).line("-1")),column:parseInt(f.oc(e.groups).column("-1"))}],message:f.oc(e.groups).message("unexpected ".concat(r,"\nexpecting ").concat(a)),unexpected:r,expecting:a}}));return{errors:B}}var H=a(L.matchAll(v)).map((function(e){var t=f.oc(e.groups).filePath("");return{type:o.SemanticError,filePath:T(t,n,u),position:[{line:parseInt(f.oc(e.groups).line("-1")),column:parseInt(f.oc(e.groups).column("-1"))},{line:parseInt(f.oc(e.groups).line1("-1")),column:parseInt(f.oc(e.groups).column1("-1"))}],message:f.oc(e.groups).message("")}}));return{errors:H}}var R={errors:[]};if(t.ast||t.desc){var F=O(y,"ast");A.ast=F;var M=w(JSON.parse(p.readFileSync(F,"utf8")),n,u),V=d.path2uri(r);R.file=V,R.ast=M[V],delete M[V],R.dependencyAsts=M,R.alias=I(R.ast,M);var K=N(R.ast,M),D=P(R.ast,R.alias,K),G=D.contract,Y=D.abi;R.abi=Y,R.contract=G,R.structs=k(R.ast,M)}var U=null;if(t.asm||t.desc){var W=O(y,"asm");A.asm=W;var J=(U=JSON.parse(p.readFileSync(W,"utf8"))).sources;R.asm=U.output.map((function(e){if(!t.debug)return{opcode:e.opcode};var r=S.exec(e.src);if(r&&r.groups){var a,i=parseInt(r.groups.fileIndex),o=r.groups.tagStr;/\w+\.\w+:0/.test(o)&&(a=c.FuncStart),/\w+\.\w+:1/.test(o)&&(a=c.FuncEnd),/loop:0/.test(o)&&(a=c.LoopStart);var s=J[i]?{file:J[i]?T(J[i],n,u):void 0,line:J[i]?parseInt(r.groups.line):void 0,endLine:J[i]?parseInt(r.groups.endLine):void 0,column:J[i]?parseInt(r.groups.col):void 0,endColumn:J[i]?parseInt(r.groups.endCol):void 0}:void 0;return{opcode:e.opcode,stack:e.stack,pos:s,debugTag:a}}throw new Error("Compile Failed: Asm output parsing Error!")})),t.debug&&(R.autoTypedVars=U.autoTypedVars.map((function(e){var t=S.exec(e.src);if(t&&t.groups){var r=parseInt(t.groups.fileIndex),a=J[r]?{file:J[r]?T(J[r],n,u):void 0,line:J[r]?parseInt(t.groups.line):void 0,endLine:J[r]?parseInt(t.groups.endLine):void 0,column:J[r]?parseInt(t.groups.col):void 0,endColumn:J[r]?parseInt(t.groups.endCol):void 0}:void 0;return{name:e.name,type:e.type,pos:a}}})))}if(t.desc){t.outputToFiles=!0;var q=O(y,"desc");A.desc=q;var $={version:3,compilerVersion:x(t.cmdPrefix?t.cmdPrefix:C()),contract:R.contract,md5:h(j),structs:R.structs||[],alias:R.alias||[],abi:R.abi||[],file:"",asm:R.asm.map((function(e){return e.opcode.trim()})).join(" "),sources:[],sourceMap:[]};t.debug&&t.sourceMap&&U&&Object.assign($,{file:R.file,sources:U.sources.map((function(e){return T(e,n,u)})),sourceMap:U.output.map((function(e){return e.src}))}),p.writeFileSync(q,JSON.stringify($,null,4)),R.compilerVersion=$.compilerVersion,R.md5=$.md5}return R}finally{t.outputToFiles?Object.keys(A).forEach((function(e){var n=A[e];p.existsSync(n)&&(t[e]?p.renameSync(n,n.replace("stdin",s.basename(r,".scrypt"))):p.unlinkSync(n))})):Object.values(A).forEach((function(e){p.existsSync(e)&&p.unlinkSync(e)}))}},t.compilerVersion=x,t.getABIDeclaration=P,t.resolveArrayTypeWithConstInt=E,t.getStructDeclaration=k,t.getAliasDeclaration=I,t.getStaticConstIntDeclaration=N,t.getPlatformScryptc=_,t.getDefaultScryptc=C,t.desc2CompileResult=function(e){var t=e.sources,r=e.asm.split(" "),n="Contract description version deprecated,  Please update your sCrypt extension to the latest version and recompile";if(void 0===e.version)throw new Error(n);return e.version<3&&console.warn(n),{compilerVersion:e.compilerVersion,contract:e.contract,md5:e.md5,abi:e.abi,structs:e.structs,alias:e.alias,file:e.file,errors:[],asm:r.map((function(r,n){var a=e.sourceMap&&e.sourceMap[n];if(a){var i=S.exec(a);if(i&&i.groups){var o=parseInt(i.groups.fileIndex);return{pos:t[o]?{file:t[o],line:t[o]?parseInt(i.groups.line):void 0,endLine:t[o]?parseInt(i.groups.endLine):void 0,column:t[o]?parseInt(i.groups.col):void 0,endColumn:t[o]?parseInt(i.groups.endCol):void 0}:void 0,opcode:r,stack:[]}}}return{opcode:r,stack:[]}}))}}}},[[405,1,2]]]);
//# sourceMappingURL=main.8a30ebc9.chunk.js.map